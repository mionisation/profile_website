<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Michael Ion">
    <meta name="description" content="Michael Ion&#39;s personal website">
    <meta name="keywords" content="blog,developer,personal,data,scala,python">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Comparing transportation costs in Vienna - A R/Shiny example project"/>
<meta name="twitter:description" content="A R/Shiny app for an entry in a competition that analyzes transportation costs in Vienna, Austria"/>

    <meta property="og:title" content="Comparing transportation costs in Vienna - A R/Shiny example project" />
<meta property="og:description" content="A R/Shiny app for an entry in a competition that analyzes transportation costs in Vienna, Austria" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://ion.bz/posts/2017-02-21-comparing-transportation-project/" />
<meta property="article:published_time" content="2017-02-21T20:12:01+00:00" />
<meta property="article:modified_time" content="2017-02-21T20:12:01+00:00" />


    
      <base href="http://ion.bz/posts/2017-02-21-comparing-transportation-project/">
    
    <title>
  Comparing transportation costs in Vienna - A R/Shiny example project · Michael Ion
</title>

    
      <link rel="canonical" href="http://ion.bz/posts/2017-02-21-comparing-transportation-project/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="http://ion.bz/css/coder.min.60ec3ae69e7338ec6d89bd8659bfd6767ced8fe1ef4381880eedbbe95e06efae.css" integrity="sha256-YOw65p5zOOxtib2GWb/Wdnztj&#43;HvQ4GIDu276V4G764=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    

    <link rel="icon" type="image/png" href="http://ion.bz/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://ion.bz/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.69.0" />
  </head>

  
  
  <body class="colorscheme-light">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://ion.bz/">
      Michael Ion
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://ion.bz/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://ion.bz/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://ion.bz/contact/">Contact me</a>
          </li>
        
      
      
        
        
        
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Comparing transportation costs in Vienna - A R/Shiny example project</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2017-02-21T20:12:01Z'>
                February 21, 2017
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              4-minute read
            </span>
          </div>
          <div class="categories">
  <i class="fas fa-folder"></i>
    <a href="http://ion.bz/categories/analytics/">Analytics</a></div>

          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="http://ion.bz/tags/analytics/">analytics</a>
      <span class="separator">•</span>
    <a href="http://ion.bz/tags/data/">data</a>
      <span class="separator">•</span>
    <a href="http://ion.bz/tags/r/">R</a></div>

        </div>
      </header>

      <div>
        
        <p><img src="http://ion.bz/images/energy/vis.png" alt="Complete Visualization: Public vs. Car transportation cost in Vienna">
With some time during my holidays, I took part in the Open Energy Data Challenge 2017<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> organized by the City of Vienna council. The aim of the project was to come up with an original idea for putting the publicly available data of the most recent energy report<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> to good use.</p>
<!-- raw HTML omitted -->
<h1 id="looking-through-the-data">Looking through the data</h1>
<p>For this, all participants received numerous excel files that contain all the data in a neat tabular form and additional visualizations used in the report. There were a lot of different attributes, but at the first glance, it was hard to put something useful together. The data included everything about consumption, prices and distribution of energy. By energy, everything was included - Fuel to power cars, electricity produced by various sources like wind farms or coal plants, and so on. It was split up into data on industry and private homes. Some of the attributes concerned only Vienna, some only different states, some information was only available aggregated on the whole of Austria. Some were only measures for the year 2013, others included dates back to 20, 30 years ago. It was a mess.</p>
<p>I first wanted to make a cool map-based visualizations that the user could manipulate, but the data was clearly not cut out for that. But for what was it, then?</p>
<p>Well, after carefully looking through each single file, I noticed there was some interesting data on car usage, fuel price, yearly ticket costs for public transport and other transportation-related items. I decided to do a visualization to compare what the average Austrian citizen spends on public transport with what he would spend on fuel using a car.</p>
<h1 id="building-the-project">Building the project</h1>
<h2 id="using-shiny">Using Shiny</h2>
<p>I used the <a href="http://shiny.rstudio.com">R Shiny web framework</a> for this. It is a very intuitive way to bring R programs to the web. In short, you write all the app in R in this form:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">library</span>(shiny)
ui <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fluidPage</span>()
server <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(input, output) {}
<span style="color:#a6e22e">shinyApp</span>(ui <span style="color:#f92672">=</span> ui, server <span style="color:#f92672">=</span> server)
</code></pre></td></tr></table>
</div>
</div><p>All the layouting information comes into <em>ui</em>, all the data access, manipulation and usage of visualization methods go in <em>server</em>. Then, you need to connect the pieces in the server to the interface elements in <em>ui</em>. A great tutorial and everything you need to know you can find on the <a href="%5Bhttp://shiny.rstudio.com/tutorial/%5D">dedicated shiny page</a>. I used the <a href="https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html">solarized theme</a> for the plots and the <a href="https://rstudio.github.io/shinythemes/">flatly theme</a> for Shiny.</p>
<h2 id="the-final-product">The final product</h2>
<p>The web app is split into three parts:</p>
<p>On the left there are the user control to manipulate the visualizations. We can modify the car consumption, daily drive kilometers, how many drivers are present in Vienna and if we want to have cost per year or daily costs. If you don&rsquo;t specify certain values, you can tick a box to use real (averaged) values.
<img src="http://ion.bz/images/energy/left.png" alt="Left: Control panel of Visualization"></p>
<p>In the middle there is the display of transport cost per person plus miniature visualizations on price developments. Price developments are visible if an area in the visualization is selected. These are how the prices are calculated from the data:</p>
<ul>
<li>Public transport:
Year card price</li>
<li>Car usage:
Car km per day * Fuel price * Car Fuel Consumption</li>
</ul>
<p>If cost per day is selected, prices are divided by 365. Not all the information I needed here was to be found in the energy report<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>, so I had to find other sources as well<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>. Missing values between time points were estimated via linear and LOESS regression.</p>
<p><img src="http://ion.bz/images/energy/middle.png" alt="Middle part of Visualization"></p>
<p>On the right, we see the total cost of transportation of all persons according to these formulas:</p>
<ul>
<li>Public transport:
Year card price * Total tickets sold</li>
<li>Car usage:
Car km per day * Fuel price * Car Fuel Consumption * Total number of cars</li>
</ul>
<p>On the right bottom, there is an indication on how many sustainable energy plants could be built with the money that was saved from buying fuel for car when using public transport. For this, an area must be selected on the right top visualization.</p>
<p><img src="http://ion.bz/images/energy/right.png" alt="Right part of Visualization"></p>
<p>Please check out the <a href="https://mionisation.shinyapps.io/ViennaOpenEnergyDataChallenge/">final product</a>, and dig into the <a href="https://github.com/mionisation/ViennaOpenEnergyDataChallenge">sources</a> if you like!</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->Open Energy Data Challenge 2017&quot;<!-- raw HTML omitted --><!-- raw HTML omitted --> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->The &ldquo;Energy report of the City of Vienna 2016&quot;<!-- raw HTML omitted --><!-- raw HTML omitted --> <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->Additional daily kilometers, average fuel consumption of cars<!-- raw HTML omitted --><!-- raw HTML omitted -->; <!-- raw HTML omitted --><!-- raw HTML omitted -->Amount of cars in Vienna<!-- raw HTML omitted --><!-- raw HTML omitted -->; <!-- raw HTML omitted --><!-- raw HTML omitted -->Daily kilometers 2016: VCÖ Austria<!-- raw HTML omitted --><!-- raw HTML omitted -->; <!-- raw HTML omitted --><!-- raw HTML omitted -->Fuel prices 2016<!-- raw HTML omitted --><!-- raw HTML omitted -->; <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

      </div>


      <footer>
        


        
        
        
      </footer>
    </article>

    
  </section>

      </div>

      
  <footer class="footer">
    <section class="container">
      
        <p>Contact me for projects 
    <a href="mailto:michael@ion.bz?Subject=Contract%20opportunity" target="_top">here</a>.
    Get my CV <a href="http://ion.bz/assets/michael_ion_CV.pdf">here</a>.</p>
      
      
      
      
    </section>
  </footer>

    </main>

    

    

  </body>

</html>
